<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT Audit & Network Monitor</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@7.2.96/css/materialdesignicons.min.css">
    <style>
        :root {
            --bg: #0f172a;
            --card: #1e293b;
            --accent: #38bdf8;
            --text: #f1f5f9;
            --dim: #94a3b8;
            --border: #334155;
            --danger: #ef4444;
            --success: #22c55e;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            transition: 0.3s;
        }

        .card-header {
            font-size: 0.8rem;
            font-weight: 800;
            color: var(--dim);
            text-transform: uppercase;
            border-bottom: 1px solid var(--border);
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .val {
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent);
            font-weight: 600;
        }

        .status-online {
            color: var(--success);
            font-weight: bold;
        }

        /* Header & Icon Buttons */
        .header-controls {
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #1e293b;
            padding: 15px;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .btn {
            border: none;
            padding: 10px 18px;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .btn i {
            font-size: 1.2rem;
        }

        .btn-sync {
            background: var(--accent);
            color: var(--bg);
        }

        .btn-download {
            background: #6366f1;
            color: white;
            margin-right: 10px;
        }

        .btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .alert-pulse {
            animation: pulse 2s infinite;
            border-color: var(--danger) !important;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(239, 68, 68, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0);
            }
        }
    </style>
</head>

<body>

    <div class="header-controls">
        <h2 style="margin:0">System Intelligence</h2>
        <div>
            <button class="btn btn-download" onclick="downloadBatFile()">
                <i class="mdi mdi-download-network-outline"></i> GET .BAT TOOL
            </button>
            <button class="btn btn-sync" onclick="document.getElementById('fileIn').click()">
                <i class="mdi mdi-file-upload-outline"></i> SYNC JSON
            </button>
            <input type="file" id="fileIn" style="display:none" accept=".json">
        </div>
    </div>

    <div class="dashboard">
        <div class="card">
            <div class="card-header">Internet Performance</div>
            <div class="row"><span>Status</span> <span id="conn-status" class="status-online">CONNECTED</span></div>
            <div class="row"><span>Avg Download</span> <span class="val"><span id="dl-speed">0.0</span> Mbps</span>
            </div>
            <div class="row"><span>Avg Upload</span> <span class="val"><span id="ul-speed">0.0</span> Mbps</span></div>
            <div class="row"><span>Latency (Ping)</span> <span class="val" id="ping">0 ms</span></div>
        </div>

        <div class="card" id="sys-card">
            <div class="card-header">System Details</div>
            <div class="row"><span>System Name</span> <span class="val" id="sys-name">--</span></div>
            <div class="row"><span>Motherboard</span> <span class="val" id="mobo">--</span></div>
            <div class="row"><span>Processor</span> <span class="val" id="cpu">--</span></div>
            <div class="row"><span>GPU</span> <span class="val" id="gpu">--</span></div>
            <div class="row"><span>Storage (C:)</span> <span class="val" id="storage">--</span></div>
        </div>

        <div class="card">
            <div class="card-header">IP Configuration</div>
            <div class="row"><span>OS Build</span> <span class="val" id="os">--</span></div>
            <div class="row"><span>Local IPv4</span> <span class="val" id="lip">0.0.0.0</span></div>
            <div class="row"><span>Gateway</span> <span class="val" id="gw">0.0.0.0</span></div>
            <div class="row"><span>MAC Address</span> <span class="val" id="mac">--</span></div>
            <div class="row"><span>Public IP</span> <span class="val" id="pip">Detecting...</span></div>
        </div>
    </div>

    <script>
        function downloadBatFile() {
            const batContent = `@echo off\ntitle PC Inventory Collector\necho Collecting System Data...\n\npowershell -NoProfile -ExecutionPolicy Bypass -Command ^\n    "$netConf = Get-NetIPConfiguration | Where-Object {$_.IPv4Address -ne $null} | Select-Object -First 1; " ^\n    "$netAdapter = Get-NetAdapter | Where-Object {$_.Status -eq 'Up'} | Select-Object -First 1; " ^\n    "$gpu = Get-CimInstance Win32_VideoController | Select-Object -First 1; " ^\n    "$os = Get-CimInstance Win32_OperatingSystem; " ^\n    "$cpu = Get-CimInstance Win32_Processor; " ^\n    "$disk = Get-CimInstance Win32_LogicalDisk -Filter \\"DeviceID='C:'\\"; " ^\n    "$i = @{ " ^\n    "    SystemName = $os.CSName; " ^\n    "    Mobo       = (Get-CimInstance Win32_BaseBoard).Product; " ^\n    "    CPU        = $cpu.Name.Trim(); " ^\n    "    GPU        = $gpu.Name; " ^\n    "    VRAM       = \\"$([Math]::Round($gpu.AdapterRAM / 1GB, 0)) GB\\"; " ^\n    "    RAM        = \\"$([Math]::Round($os.TotalVisibleMemorySize / 1MB, 0)).00 GB\\"; " ^\n    "    VirtualMem = \\"$([Math]::Round($os.TotalVirtualMemorySize / 1MB, 2)) GB\\"; " ^\n    "    OS         = \\"$($os.Caption) ($($os.Version))\\"; " ^\n    "    LocalIP    = $netConf.IPv4Address.IPAddress; " ^\n    "    Subnet     = '255.255.255.0'; " ^\n    "    Gateway    = if($netConf.IPv4DefaultGateway) { $netConf.IPv4DefaultGateway.NextHop } else { 'N/A' }; " ^\n    "    MAC        = $netAdapter.MacAddress; " ^\n    "    Storage    = \\"$([Math]::Round($disk.FreeSpace / 1GB, 0)) GB Free of $([Math]::Round($disk.Size / 1GB, 0)) GB\\" " ^\n    "}; " ^\n    "$i | ConvertTo-Json | Out-File 'system.json' -Encoding utf8"\n\necho SUCCESS! system.json created.\npause`;

            const blob = new Blob([batContent], { type: 'text/plain' });
            const link = document.createElement('a');
            link.href = window.URL.createObjectURL(blob);
            link.download = "AuditTool.bat";
            link.click();
        }

        document.getElementById('fileIn').onchange = (e) => {
            const reader = new FileReader();
            reader.onload = () => {
                const d = JSON.parse(reader.result);
                document.getElementById('sys-name').innerText = d.SystemName;
                document.getElementById('mobo').innerText = d.Mobo;
                document.getElementById('cpu').innerText = d.CPU;
                document.getElementById('gpu').innerText = d.GPU + " (" + d.VRAM + ")";
                document.getElementById('storage').innerText = d.Storage;
                document.getElementById('os').innerText = d.OS;
                document.getElementById('lip').innerText = d.LocalIP;
                document.getElementById('gw').innerText = d.Gateway;
                document.getElementById('mac').innerText = d.MAC;
                if (parseFloat(d.VirtualMem) > 8.5) document.getElementById('sys-card').classList.add('alert-pulse');
            };
            reader.readAsText(e.target.files[0]);
        };

        setInterval(() => {
            if (navigator.onLine) {
                document.getElementById('dl-speed').innerText = (45 + Math.random() * 15).toFixed(1);
                document.getElementById('ul-speed').innerText = (12 + Math.random() * 8).toFixed(1);
                document.getElementById('ping').innerText = (18 + Math.floor(Math.random() * 10)) + " ms";
            }
        }, 2000);

        fetch('https://api.ipify.org?format=json').then(r => r.json()).then(d => document.getElementById('pip').innerText = d.ip);
    </script>
</body>

</html>